<div class="series-background" [style.background-image]="'url(https://cdn.episode.ninja/file/episodeninja/' + series.id + '.jpg)'">
  <div class="container text-white">
    <div class="series-text col-lg-9 px-0">
      <h1 class="series-name pt-1 mb-0">The {{worst ? 'Worst' : 'Best'}} {{bestSeasons ? 'Seasons' : 'Episodes'}} of {{series.seriesName}}</h1>
      <p class="series-description mb-1 mb-sm-3">Last Updated: {{series.updatedAt | date}}</p>
      <p class="series-description mb-lg-5 mb-xl-5">{{series.overview}}</p>
    </div>
  </div>
</div>
<nav class="series-nav mb-2 mb-sm-3">
  <div class="container">
    <div class="hidden-sm-up row">
      <a [href]="'https://facebook.com/sharer/sharer.php?u=https://episode.ninja' + this.router.url" target="_blank" rel="noopener" aria-label="Share on Facebook" class="sharing-button facebook col" title="Share on Facebook">
        <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0" fill-rule="nonzero"/></svg>
        <span>Share</span>
      </a>

      <a [href]="'https://twitter.com/intent/tweet/?url=https://episode.ninja' + this.router.url" target="_blank" rel="noopener" aria-label="Share on Twitter" class="sharing-button twitter col" title="Share on Twitter">
        <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z" fill-rule="nonzero"/></svg>
        <span>Tweet</span>
      </a>
    </div>
    <div class="row">
      <a
        class="col series-nav-link"
        [class.active]="!worst && !bestSeasons"
        *ngIf="series.totalEpisodes >= 50 || series.totalSeasons >= 4"
        [routerLink]="'/series/' + series.slug"
      >
        Best Episodes
      </a>
      <a
        class="col series-nav-link"
        [class.active]="worst"
        *ngIf="series.totalEpisodes >= 50"
        [routerLink]="'/series/' + series.slug + '/worst-episodes'"
      >
        Worst Episodes
      </a>
      <a
        class="col series-nav-link"
        [class.active]="bestSeasons"
        *ngIf="series.totalSeasons >= 4"
        [routerLink]="'/series/' + series.slug + '/best-seasons'"
      >
        Best Seasons
      </a>
    </div>
  </div>
</nav>
<div class="container">
  <div class="row">
    <div class="col-lg-9">
      <ng-template ngFor let-index="index" let-episode [ngForOf]="series.episodes">
        <div class="card mt-1 mb-3">
          <div class="row align-items-center">
            <div class="col-sm-12 col-md-6 col-lg-5">
              <img class="img-fluid w-100" [src]="episodeImage(episode)" [alt]="episode.episodeName" (error)="episode.filename = series.fanart">
            </div>

            <div class="col-sm-12 col-md-6 col-lg-7 h-100 py-3 px-4 px-sm-4">
              <h2 class="h2 card-title mb-1">
                #{{index + 1}} - {{episode.episodeName}}
              </h2>
              <h3 class="h6 card-subtitle text-muted mb-3">Season {{episode.airedSeason}} - Episode {{episode.airedEpisodeNumber}}</h3>
              <p class="card-text mr-3">{{episode.overview}}</p>
              <div class="float-right text-muted mr-3">
                <div class="btn-group btn-group-sm mb-2" role="group">
                  <button type="button" class="btn btn-secondary">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                      width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                      <path fill="none" d="M0,0h24v24H0V0z"/>
                      <path d="M1,21h4V9H1V21z M23,10c0-1.1-0.9-2-2-2h-6.31l0.95-4.57l0.03-0.32c0-0.41-0.17-0.79-0.44-1.06L14.17,1L7.59,7.59
                      C7.22,7.95,7,8.45,7,9v10c0,1.1,0.9,2,2,2h9c0.83,0,1.54-0.5,1.84-1.22l3.02-7.05C22.95,12.5,23,12.26,23,12V10z"/>
                    </svg>
                  </button>
                  <button type="button" class="btn btn-secondary">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                    width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                      <g>
                        <g>
                          <rect fill="none" width="24" height="24"/>
                        </g>
                        <path d="M15,3H6C5.17,3,4.46,3.5,4.16,4.22l-3.02,7.05C1.05,11.5,1,11.74,1,12l0,2c0,1.1,0.9,2,2,2h6.31l-0.95,4.57l-0.03,0.32
                          c0,0.41,0.17,0.79,0.44,1.06L9.83,23l6.59-6.59C16.78,16.05,17,15.55,17,15V5C17,3.9,16.1,3,15,3z M19,3v12h4V3H19z"/>
                      </g>
                    </svg>
                  </button>
                </div>
                <div class="episode-rating">
                  <img src="/assets/star.svg" alt="star" width="25" height="25" class="align-top"> {{episode.rating | number: '1.2-2'}}
                </div>
                {{episode.ratingCount | number:'.0'}} votes
              </div>
              <div *ngIf="episode.directors.length" class="mb-1">
                Directors: <a *ngFor="let director of episode.directors; let i = index;" [routerLink]="'/director/' + director.slug">
                  {{director.name}}<span *ngIf="i !== episode.directors.length - 1">, </span>
                </a>
              </div>
              <div *ngIf="episode.directors.length" class="mb-3">
                Writers: <span *ngFor="let writer of episode.writers; let i = index;">
                  {{writer}}<span *ngIf="i !== episode.writers.length - 1">, </span>
                </span>
              </div>
              <a [href]="episode.watchLinks[0]?.amazon" *ngIf="episode.watchLinks && episode.watchLinks[0]?.amazon" target="_blank" rel="noopener" class="btn btn-warning btn-sm mb-1">
                Watch on Amazon
              </a>
              <a [href]="episode.itunes" *ngIf="episode.itunes" target="_blank" rel="noopener" class="btn btn-secondary btn-sm mb-1">
                Buy on iTunes
              </a>
            </div>
          </div>
        </div>

        <div *ngIf="index === 4" class="card mt-1 mb-3">
          <app-amazon-ad [ad]="'3d047510-b751-4c99-bd44-c3a8e0ebb96a'" [products]="series.products" class="p-3"></app-amazon-ad>
        </div>
      </ng-template>

      <ng-template ngFor let-index="index" let-season [ngForOf]="series.seasons">
        <div class="card mt-1 mb-3">
          <div class="row align-items-center">
            <div class="col-sm-12 col-md-6 col-lg-5">
              <img class="img-fluid w-100" [src]="seasonImage(season)" [alt]="season.title" *ngIf="season.id">
            </div>

            <div class="col-sm-12 col-md-6 col-lg-7 h-100 py-3 px-4 px-sm-4">
              <h2 class="h2 card-title mb-1">
                #{{index + 1}} - {{season.title}}
              </h2>
              <h3 class="h6 card-subtitle text-muted mb-3">First Aired: {{season.first_aired | date}}</h3>
              <p class="card-text mr-3">{{season.overview}}</p>
              <div class="float-right text-muted mr-3 mt-3">
                <div class="episode-rating">
                  <img src="/assets/star.svg" alt="star" width="25" height="25" class="align-top"> {{season.rating | number: '1.2-2'}}
                </div>
                {{season.votes | number:'.0'}} votes
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </div>
    <aside class="col-lg-3 sidebar">
      <div class="container mt-1 mb-3">
        <div class="row">
          <a [href]="'https://facebook.com/sharer/sharer.php?u=https://episode.ninja' + this.router.url" target="_blank" rel="noopener" aria-label="Share on Facebook" class="sharing-button facebook col" title="Share on Facebook">
            <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0" fill-rule="nonzero"/></svg>
            <span>Share</span>
          </a>

          <a [href]="'https://twitter.com/intent/tweet/?url=https://episode.ninja' + this.router.url" target="_blank" rel="noopener" aria-label="Share on Twitter" class="sharing-button twitter col" title="Share on Twitter">
            <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z" fill-rule="nonzero"/></svg>
            <span>Tweet</span>
          </a>
        </div>
      </div>

      <app-amazon-ad [ad]="'eff08152-9faf-4f4e-94a7-14ba379d3517'" [products]="series.products" *ngIf="series.products !== undefined"></app-amazon-ad>
      <app-popular-shows sidebar="true" [shows]="series.relatedShows"></app-popular-shows>
    </aside>
  </div>
</div>
